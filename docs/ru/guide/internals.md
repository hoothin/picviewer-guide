---
title: Внутренние механизмы
---

# Внутренние механизмы и процесс сопоставления

Скрипт непрерывно отслеживает курсор и элементы изображений на странице, выполняя сопоставление правил и разрешение адресов изображений.

## Основной процесс

1. **Сопоставление сайта**: Определяет, включить ли правило, на основе `url`.
2. **Сопоставление изображения**: Разрешает адрес оригинала на основе `src`, `r/s` или `getImage`.
3. **Обработка не-изображений**: Использует `ext` или `getExtSrc` для поиска соседних изображений.
4. **Запрос внутренней страницы**: При необходимости использует `xhr` для получения внутренней страницы и извлечения изображения.
5. **Возврат результата**: Передает разрешенный URL в плавающую панель и галерею.

## Обработка ленивой загрузки

В скрипт встроено сканирование различных атрибутов ленивой загрузки, он может автоматически извлекать реальные адреса из атрибутов `data-*`.
Если целевой сайт использует специальные поля, можно указать `lazyAttr` в правиле.

## Повторное использование результатов

Разрешенные адреса повторно используются в последующих операциях, таких как сбор в галерею, пакетная загрузка и поиск по картинке.